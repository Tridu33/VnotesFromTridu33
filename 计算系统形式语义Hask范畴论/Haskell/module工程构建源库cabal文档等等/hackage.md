# hackage





https://hackage.haskell.org/upload


**张淞书**本有讲案例做包


[Creating a package on Hackage](https://begriffs.com/posts/2014-10-25-creating-package-hackage.html)


[将软件包上传到hackage](https://svejcar.dev/posts/2020/02/29/uploading-package-to-hackage/)
























上载软件包会将其放入软件包索引中， 以便任何人都可以下载它并查看有关它的信息。您只能上传一次软件包版本，并且无法撤消，因此请尝试第一次正确安装！为了减少出错的风险，建议使用以下介绍的候选软件包。

由于添加到主程序包索引中的每个程序包都具有与其相关的运行和维护成本，因此您的程序包应通过对其他人有用的方式努力为社区提供价值，这需要为您的程序包提供有意义的提要/描述，如：并通过帮助提供准确的元数据来确保您的软件包可安装。

软件包必须采用Cabal的sdist命令生成的格式 ：gzip压缩的tar文件package - version .tar.gz， 包括目录package - version，其中包含该名称和版本的软件包，包括package .cabal。请参阅页面底部的注释。


软件包版本控制
默认情况下，上传软件包策划这意味着这两个维护和hackage受托人可以修改自己的元数据（尤其是涉及版本界限）指导构建工具生产安装，计划。（有关修订的更多信息，请参阅FAQ）。

为了确保Hackage / Cabal生态系统的完整性和良好的功能，所有策划的软件包都应遵循Haskell的软件包版本控制策略（PVP）。

特别要注意的是，尽管PVP和SemVer基于相同的概念，但它们在结构上有很大不同，因此彼此不兼容。有关差异和相关问题的更多详细信息，请查阅PVP / SemVer常见问题解答部分。

此外，PVP合同的一个重要属性是，它不仅有效，而且不仅受到单个软件包的约束，而且还受到该软件包的传递依赖关系的支持，才能提供足够有力的保证。因此，策划的包装应旨在仅依赖于其他策划的包装。

在策划过程中， Hackage受托人需要能够与软件包维护者联系，以告知他们有关软件包的问题（包括其元数据），并帮助解决这些问题，这些问题会影响Hackage生态系统。

打包上传者可以通过将打包的cabal文件的x-curation：字段设置为uncurated，选择从策划中排除单个打包上传。未策划的软件包对版本策略没有期望。受托人或维护人员可以采用uncurated封装成通过元数据的修改的策展层。元数据修订版本不得将x-curation字段的值设置为uncurated的任何变体。

支持uncurated属性的两个变体。首先，uncurated-no-trustee-contact，它表示受托人不希望维护人员就软件包的任何元数据问题与维护者联系。（与授权无关的问题仍可能发生联系，例如许可等）。其次，uncurated-seeking-adoption，它表示维护者希望其软件包在策展层中采用，但是目前有一些问题阻止了这种情况，他们希望获得帮助。

将来，有关策展的元数据将在Hackage的UI中提供，并且将为未策划和策划的包层提供不同的派生索引。



包装候选人
候选软件包是一种预览软件包页面，查看任何警告或您可能遇到的错误以及让他人在将其发布到主索引之前进行安装的一种方法。（注意：您可以通过'cabal check'查看这些警告。）您可以同时为每个软件包有多个候选，只要它们的版本不同即可。最后，如果主索引尚不存在，您可以将其发布。

候选软件包尚未得到充分实施，并且仍在改进中；有关仍需要完成的工作的概述，请参见“打包候选项目”仪表板。

上载候选软件包





笔记
您应该检查您的源包是否已构建，包括haddock文档（如果是库）。
类别取决于您在Category字段中输入的内容。您应该尽可能选择现有的类别。您可以有多个类别，以逗号分隔。如果没有其他版本的软件包，则类别将自动成为软件包的标签。
GHC基本软件包的偶尔更改可能意味着需要做一些工作才能使软件包在多个版本之间兼容。有关如何操作的提示，请参见这些说明。还有一些有关升级旧软件包的注意事项。
hackage-server尝试构建库软件包的文档，但这可能会失败。维护人员可以生成自己的文档，并通过使用以下外壳程序脚本中的内容来上传文档（请注意，最后两个命令是关键的）：





```
#!/bin/sh
set -e

dir=$(mktemp -d dist-docs.XXXXXX)
trap 'rm -r "$dir"' EXIT

# assumes cabal 2.4 or later
cabal v2-haddock --builddir="$dir" --haddock-for-hackage --enable-doc

cabal upload -d --publish $dir/*-docs.tar.gz
```

